char control_js[] = "\n\nfunction OnLedBtnClick(event) {\n    // console.log(\"OnLedBtnClick\")\n    var classList = event.srcElement.classList;\n\n    if (classList.contains('RequestYellowLed')) {\n        classList.remove('RequestYellowLed');\n        classList.add('YellowLed');\n    } else if (classList.contains('GreenLed')) {\n        classList.remove('GreenLed');\n        classList.add('ErrLed');\n    } else if (classList.contains('ErrLed')) {\n        classList.remove('ErrLed');\n        classList.add('GreenLed');\n    } else if (classList.contains('YellowLed')) {\n        classList.remove('YellowLed');\n    } else {\n        classList.add('GreenLed');\n    }\n}\n\nfunction OnLedBtnPress(event) {\n    // console.log(\"OnLedBtnPress\")\n    // console.log(event)\n    // console.log(event.srcElement)\n    // console.log(event.srcElement.classList)\n\n    var classList = event.srcElement.classList;\n\n    if (classList.contains('GreenLed')) {\n        // console.log(\"dbclick g\")\n    } else if (classList.contains('ErrLed')) {\n        // console.log(\"dbclick e\")\n    } else if (classList.contains('YellowLed')) {\n        // console.log(\"dbclick y\")\n    } else {\n        classList.add('RequestYellowLed');\n    }\n}\n\n\nfunction Init_LedBtn() {\n    var elements = document.getElementsByClassName(\"LedBtn\");\n\n\n    for (var i = 0; i < elements.length; i++) {\n        var pressTimer;\n\n        elements[i].onmouseup = function () {\n            clearTimeout(pressTimer)\n        }\n\n        elements[i].onmousedown = function (event) {\n            pressTimer = window.setTimeout(OnLedBtnPress, 1000, event)\n        }\n\n        elements[i].addEventListener('click', OnLedBtnClick, false);\n\n\n\n        // elements[i].classList.remove('GreenLed');\n        // elements[i].classList.remove('ErrLed');\n        // elements[i].classList.remove('YellowLed');\n    }\n}\n\nfunction OnDOBtnClick(event) {\n    // if (event.srcElement.classList.contains('ActiveBtn')) {\n    //     event.srcElement.classList.remove('ActiveBtn');\n    // } else {\n    //     event.srcElement.classList.add('ActiveBtn');\n    // }\n}\n\nfunction Init_DOBtn() {\n    var elements = document.getElementsByClassName(\"DOBtn\");\n\n\n    for (var i = 0; i < elements.length; i++) {\n        elements[i].addEventListener('click', OnDOBtnClick, false);\n\n        elements[i].classList.remove('ActiveBtn');\n    }\n}\n\nfunction SetActiveBtn(el, isActive) {\n    // console.log('SetActiveBtn')\n    // console.log(el)\n    // console.log(el.classList)\n\n    el.classList.remove('ActiveBtn');\n\n    if (isActive) {\n        el.classList.add('ActiveBtn')\n    }\n\n}\n\nconst ActionMode = {\n    Config: 0,\n    Free: 1,\n    Connect: 2,\n    SelfTest: 3,\n    Update: 4\n}\n\nfunction EnableDO(isEnable) {\n    var elements = document.getElementById('DOPanel').getElementsByClassName(\"DOBtn\");\n\n    for (let x of elements) {\n        // console.log(x.disabled)\n        x.disabled = !isEnable;\n    }\n}\n\nfunction EnableLedBtn(isEnable) {\n    var elements = document.getElementById('LedPanel').getElementsByClassName(\"LedBtn\");\n\n    for (let x of elements) {\n        // console.log(x.disabled)\n        x.disabled = !isEnable;\n    }\n}\n\n\n\nfunction InitModeDropBox() {\n    var element = document.getElementById('modeDropBox')\n\n    var OnModeDropBoxChange = function () {\n        if (element.value == ActionMode.Config) {\n            EnableDO(false)\n            EnableLedBtn(true)\n        } else if (element.value == ActionMode.SelfTest) {\n            // console.log('selftest')\n            EnableDO(true)\n            EnableLedBtn(true)\n        } else if (element.value == ActionMode.Free) {\n            // console.log('Free')\n            EnableDO(false)\n            EnableLedBtn(true)\n        } else if (element.value == ActionMode.Connect) {\n            // console.log('Connect')\n            EnableDO(false)\n            EnableLedBtn(false)\n        } else {\n            EnableDO(false)\n            EnableLedBtn(false)\n        }\n\n\n    }\n\n    OnModeDropBoxChange();\n\n    element.onchange = OnModeDropBoxChange\n}\n\n\nconst LogLevelList = [\n    'ALL',\n    'DEBUG',\n    'INFO',\n    'WARN',\n    'ERROR',\n    'CRITICAL'\n]\n\nconst LogLevelStyleClassList = {\n    'WARN': 'LogWarn',\n    'ERROR': 'LogErr',\n    'CRITICAL': 'LogCritical'\n}\n\n\nfunction UpdateLog(log) {\n    var logContentView = document.getElementById('logContent')\n    var logFilterSelect = document.getElementById('logFilterSelect')\n\n    var isAtBottom = false;\n\n    if ((logcontent.offsetHeight + Math.round(logContentView.scrollTop)) >= logContentView.scrollHeight) {\n        // you're at the bottom of the page\n        isAtBottom = true;\n    }\n\n    var logLine = logContentView.getElementsByTagName(\"p\")\n    var isFullLog = false;\n    if (logLine.length > 500) {\n        isFullLog = true;\n    }\n    \n    const lines = log.split(/\\r?\\n/);\n\n    // console.log(lines)\n    for (var line of lines) {\n        // console.log(line)\n        if (isFullLog) {\n            logLine[0].remove()\n        }\n        logContentView.innerHTML += `<p> ${line} </p>`\n\n        var newLine = logLine[logLine.length - 1];\n        if (newLine.innerText.indexOf('WARN') >= 0) {\n            newLine.classList.add(LogLevelStyleClassList.WARN)\n        } else if (newLine.innerText.indexOf('ERROR') >= 0) {\n            newLine.classList.add(LogLevelStyleClassList.ERROR)\n        } else if (newLine.innerText.indexOf('CRITICAL') >= 0) {\n            newLine.classList.add(LogLevelStyleClassList.CRITICAL)\n        }\n\n        if (logFilterSelect.value != 0) {\n            var logLevel = LogLevelList[logFilterSelect.value]\n\n            // console.log(newLine)\n\n            if (newLine.innerText.indexOf(logLevel) >= 0) {\n                \n            } else {\n                \n                newLine.style.display = 'none';\n            }\n        }\n\n    }\n    \n\n    if (isAtBottom)\n    {\n\n    logContentView.scrollTo(0, logContentView.scrollHeight)\n    }\n}\n\nfunction ParserSttResID(id, data) {\n    // console.log(data)\n\n\n    // console.log(el)\n    if ('di' in data) {\n        UpdateLog(`1:1:1 DEBUG    - di: ${data.di}`)\n        UpdateLog(`1:1:1 INFO     - di: ${data.di}`)\n        UpdateLog(`1:1:1 WARN     - di: ${data.di}`)\n        UpdateLog(`1:1:1 ERROR    - di: ${data.di}`)\n        UpdateLog(`1:1:1 CRITICAL - di: ${data.di}`)\n        \n        var DIRow = document.getElementById(\"DIPanel\").getElementsByClassName(id)[0]\n        \n        // console.log(DIRow)\n        for (var i = 1; i <= 6; i++) {\n            var diBtn = DIRow.getElementsByClassName(`di${i}`)[0]\n\n            \n            SetActiveBtn(diBtn, data.di & (1 << i))\n        }\n\n    }\n}\n\nfunction ParserSttResLog(data) {\n    var el = document.getElementById('logContent').innerHTML;\n\n    el += data\n}\n\n\nfunction ParserSttRes(data) {\n    if ('q1' in data) {\n        ParserSttResID('q1', data.q1)\n    }\n\n    if ('q2' in data) {\n        ParserSttResID('q2', data.q2)\n    }\n\n    if ('q3' in data) {\n        ParserSttResID('q3', data.q3)\n    }\n\n    if ('q4' in data) {\n        ParserSttResID('q4', data.q4)\n    }\n\n    if ('q5' in data) {\n        ParserSttResID('q5', data.q5)\n    }\n\n    if ('q6' in data) {\n        ParserSttResID('q6', data.q6)\n    }\n\n    if ('ts' in data) {\n        document.getElementById('timeStamp').innerHTML = data.ts\n    }\n\n    if ('log' in data) {\n        ParserSttResLog(data.log)\n    }\n}\n\nfunction StartGetStatus()\n{\n    let xhr = new XMLHttpRequest();\n\n    xhr.responseType = 'json';\n\n    function ReGetStatus() {\n        xhr.open('GET', '/api/stt')\n        xhr.send()\n    }\n\n\n\n    xhr.onload = function() {\n        if (xhr.status != 200) {\n            alert(`Error ${xhr.status}: ${xhr.statusText}`);\n        } else {\n            res = xhr.response\n            // console.log(res);\n\n            ParserSttRes(res);\n        \n            ReGetStatus();\n        }\n    };\n    \n    ReGetStatus();\n\n}\n// document.getElementById('modeDropBox').onchange = function (event) {\n//     alert(\"modeDropBox\")\n// }\n\n// Init_LedBtn()\n// Init_DOBtn()\n// InitModeDropBox()\nfunction LogScrollUp()\n{\n    // alert('up')\n    var logContentView = document.getElementById('logContent')\n    logContentView.scrollTo(0, 0)\n}\n\nfunction LogScrollDown()\n{\n    // alert('down')\n    var logContentView = document.getElementById('logContent')\n    logContentView.scrollTo(0, logContentView.scrollHeight)\n}\n\nfunction LogFilter(logLevel)\n{\n    // const LogLevel = {\n    //     'ALL': 0,\n    //     'DEBUG': 1,\n    //     'INFO': 2,\n    //     'WARN': 3,\n    //     'ERROR': 4,\n    //     'CRITICAL': 5\n    // }\n\n    // alert('down')\n    var logContentView = document.getElementById('logContent')\n    var logLine = logContentView.getElementsByTagName(\"p\")\n\n    if (logLevel == 0) {\n        for (var line of logLine) {\n            line.style.display = 'block';\n        }\n    } else {\n\n        const logLevelStr = LogLevelList[logLevel]\n\n        for (var line of logLine)\n        {\n            // console.log(line)\n            if (line.innerText.indexOf(logLevelStr) >= 0)\n            {\n                line.style.display = 'block';\n            }\n            else {\n                line.style.display = 'none';\n            }\n        }\n    }\n\n\n\n\n    // logContentView.scrollTo(0, logContentView.scrollHeight)\n}";
